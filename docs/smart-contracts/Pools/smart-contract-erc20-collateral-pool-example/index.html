<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-smart-contracts/Pools/smart-contract-erc20-collateral-pool-example" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Example | Defactor Developer Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.defactor.com/documentation/img/defactor-social-card.jpeg"><meta data-rh="true" name="twitter:image" content="https://docs.defactor.com/documentation/img/defactor-social-card.jpeg"><meta data-rh="true" property="og:url" content="https://docs.defactor.com/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-example"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Example | Defactor Developer Docs"><meta data-rh="true" name="description" content="In-depth Actions"><meta data-rh="true" property="og:description" content="In-depth Actions"><link data-rh="true" rel="icon" href="/documentation/img/Defactor_Favicon-32x32.png"><link data-rh="true" rel="canonical" href="https://docs.defactor.com/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-example"><link data-rh="true" rel="alternate" href="https://docs.defactor.com/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-example" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.defactor.com/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-example" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://E3S6H07ZZJ-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Defactor Developer Docs" href="/documentation/opensearch.xml"><link rel="stylesheet" href="/documentation/assets/css/styles.e52ce47d.css">
<script src="/documentation/assets/js/runtime~main.ce3dfb44.js" defer="defer"></script>
<script src="/documentation/assets/js/main.43a05d0b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/"><div class="navbar__logo"><img src="/documentation/img/Defactor-Logo-Dark.svg" alt="Defactor logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/documentation/img/Defactor-Logo-Light.svg" alt="Defactor logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/documentation/docs/category/api">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/defactor-com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/documentation/docs/category/api">API</a><button aria-label="Expand sidebar category &#x27;API&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/documentation/docs/category/smart-contracts">Smart Contracts</a><button aria-label="Collapse sidebar category &#x27;Smart Contracts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/docs/smart-contracts/">Defactor Contracts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/documentation/docs/category/pools-1">Pools</a><button aria-label="Collapse sidebar category &#x27;Pools&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-technical-aspects">Technical Aspects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-example">Example</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/documentation/docs/category/erc20-collateral-pool">ERC20 Collateral Pool</a><button aria-label="Expand sidebar category &#x27;ERC20 Collateral Pool&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/documentation/docs/category/staking">Staking</a><button aria-label="Expand sidebar category &#x27;Staking&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/documentation/docs/category/front-end">Front End</a><button aria-label="Expand sidebar category &#x27;Front End&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/documentation/docs/category/real-world-use-cases">Real World Use Cases</a><button aria-label="Expand sidebar category &#x27;Real World Use Cases&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/documentation/docs/category/smart-contracts"><span itemprop="name">Smart Contracts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/documentation/docs/category/pools-1"><span itemprop="name">Pools</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Example</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Example</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="in-depth-actions">In-depth Actions<a href="#in-depth-actions" class="hash-link" aria-label="Direct link to In-depth Actions" title="Direct link to In-depth Actions">​</a></h2>
<p>The flow starts when the borrower creates a new pool giving as collateral one or multiple assets that follows the <code>ERC20</code>, <code>ERC721</code> or <code>ERC1155</code> standards. Once the pool is created and the collateral has been successfully transferred from the borrower&#x27;s wallet to the contract, the pool will be marked as <code>CREATED</code> that means it is ready to start receiving funds from the investors. The pool was configured initially with a soft and hard cap, when the total amount committed to the pool reaches at least the soft cap the borrower (pool owner) can decide whether to collect the funds or wait until the hard cap is reached. When the owner collectes the raised capital, no new commits or un-commit are allowed to the pool this is because the borrower has already took the funds and the investors will need to wait until the rewards start coming in.</p>
<p>As long as the pool is active, the borrower can deposit the rewards in any frequency they want, when the loan is paid (partial or complete) the investors are the only one allowed to claim the rewards.</p>
<p>Once the pool owner completes their goal by creating the pool and decides to close it, the investors will have to claim their reward in the following 60 days because later the pool can be archived and therefore no other action will be allowed to that specific pool. Any leftover reward will be will be accredited to the contract as a fee collected.</p>
<p>Lets consider the following example to better understand how this flow works:</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pool-lifecycle">Pool lifecycle<a href="#pool-lifecycle" class="hash-link" aria-label="Direct link to Pool lifecycle" title="Direct link to Pool lifecycle">​</a></h2>
<ul>
<li>Event #1 -&gt; <em>The contract is initialized with the USDC address that will be used for lending money</em>.</li>
<li>Event #2 -&gt; Bob creates a new pool with a soft cap of 1000 USDC and a hard cap of 2000 USDC, using 100 tokens of GOLD as collateral.</li>
<li>Event #3 -&gt; Alice commits 1100 USDC to the pool.</li>
<li>Event #4 -&gt; Bob collects the funds from the pool.</li>
<li>Event #5 -&gt; After 30 days, Bob deposits 1100 USDC as rewards into the pool.</li>
<li>Event #6 -&gt; After 60 days, Alice claims 1100 USDC as rewards from the pool.</li>
<li>Event #7 -&gt; Bob closes the pool.</li>
</ul>
<p>Let&#x27;s break this down to know what is under the hood of each event:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-1-contract-initialization">Event #1 (contract initialization)<a href="#event-1-contract-initialization" class="hash-link" aria-label="Direct link to Event #1 (contract initialization)" title="Direct link to Event #1 (contract initialization)">​</a></h3>
<ul>
<li>The contract is initialized with the USDC token address that will be used for lending money, and the initializer will be the admin of the contract.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-2-create-a-pool">Event #2 (create a pool)<a href="#event-2-create-a-pool" class="hash-link" aria-label="Direct link to Event #2 (create a pool)" title="Direct link to Event #2 (create a pool)">​</a></h3>
<ul>
<li>
<p>Anyone can create a pool; the contract only requests a fee of 200 USDC, so Bob must have at least 200 USDC tokens in his wallet.</p>
</li>
<li>
<p>The pool is created with a soft cap of 1000 USDC and a hard cap of 2000 USDC.</p>
</li>
<li>
<p>A pool instance is created with the collateral tokens provided by Bob.</p>
</li>
<li>
<p>The pool status will be marked as <code>CREATED</code>.</p>
</li>
<li>
<p>Transfer Bob&#x27;s GOLD collateral tokens from his wallet to the contract.</p>
</li>
<li>
<p>Emit the event PoolCreated.</p>
</li>
</ul>
<p>Before the pool is created:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the pool is created:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768289&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632286&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The pools status is set to 0 which represents <code>CREATED</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-3-commit-to-a-pool">Event #3 (commit to a pool)<a href="#event-3-commit-to-a-pool" class="hash-link" aria-label="Direct link to Event #3 (commit to a pool)" title="Direct link to Event #3 (commit to a pool)">​</a></h3>
<ul>
<li>
<p>The commits to the pool can happen only when the pool status is <code>CREATED</code> and the pool has not reached the hard cap.</p>
</li>
<li>
<p>1100 USDC is committed to the pool and added to the total committed amount.</p>
</li>
<li>
<p>Add the 1100 USDC to the commits that Alice has made to the pool.</p>
</li>
<li>
<p>Make the transfer of 1100 USDC from Alice&#x27;s wallet to the contract.</p>
</li>
<li>
<p>Emit the event <code>CommittedToPool</code>.</p>
</li>
</ul>
<p>Before the investor commits to the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the investor commits to the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lending data:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ &quot;amount&quot;: &quot;1100000000&quot;, &quot;claimedAmount&quot;: &quot;0&quot; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The pool information is updated to reflect the new total committed amount.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-4-collect-from-pool">Event #4 (collect from pool)<a href="#event-4-collect-from-pool" class="hash-link" aria-label="Direct link to Event #4 (collect from pool)" title="Direct link to Event #4 (collect from pool)">​</a></h3>
<ul>
<li>
<p>This can only be done by the pool owner, for this example, it would be Bob.</p>
</li>
<li>
<p>Since bob&#x27;s pool has already reached the soft cap of 1000 USDC, Bob is allowed to collect the pool.</p>
</li>
<li>
<p>The contract will charge a 2% fee on the total amount committed to the pool, in this case, 22 USDC.</p>
</li>
<li>
<p>This fee amount is then added to the contract&#x27;s collected fee.</p>
</li>
<li>
<p>The pool status will be marked with the status <code>ACTIVE</code>.</p>
</li>
<li>
<p>Make the transfer of <code>total commited to pool - 2% contract fee</code> USDC tokens from the contract to Bob&#x27;s wallet.</p>
</li>
<li>
<p>Emit the event <code>PoolCollected</code>.</p>
</li>
</ul>
<p>Before the borrower collects the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the borrower collects the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lending data:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ &quot;amount&quot;: &quot;1100000000&quot;, &quot;claimedAmount&quot;: &quot;0&quot; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When the owner collected the pool, the pool status is set to 1 which represents <code>ACTIVE</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-5-deposit-rewards">Event #5 (deposit rewards)<a href="#event-5-deposit-rewards" class="hash-link" aria-label="Direct link to Event #5 (deposit rewards)" title="Direct link to Event #5 (deposit rewards)">​</a></h3>
<ul>
<li>
<p>This can only be done by the pool owner, in this case, it would be Bob.</p>
</li>
<li>
<p>The amount of 1100 USDC is deposited to the pool as rewards.</p>
</li>
<li>
<p>Make the transfer of 1100 USDC from Bob&#x27;s wallet to the contract.</p>
</li>
<li>
<p>Emit the event <code>RewardsDeposited</code>.</p>
</li>
</ul>
<p>Before the borrower deposit to the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the borrower deposit to the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lending data:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ &quot;amount&quot;: &quot;1100000000&quot;, &quot;claimedAmount&quot;: &quot;0&quot; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now that the borrower has paid the loan, the total rewards is updated with the amount deposited, for this specific example, the amount is equal to the amount lent.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-6-claim-rewards">Event #6 (claim rewards)<a href="#event-6-claim-rewards" class="hash-link" aria-label="Direct link to Event #6 (claim rewards)" title="Direct link to Event #6 (claim rewards)">​</a></h3>
<ul>
<li>
<p>This can only be done when the pool status is <code>CLOSED</code> or <code>ACTIVE</code>.</p>
</li>
<li>
<p>Alice can now claim the total rewards as she was the only one who committed to the pool.</p>
</li>
<li>
<p>The rewards are calculated as follows:</p>
</li>
</ul>
<div class="language-solidity codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-solidity codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">((pool.totalRewards * poolCommit.amount) / pool.totalCommitted) - poolCommit.claimedAmount</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>The rewards are then added to the Alice&#x27;s total claimed amount and then added to the rewards paid out by the pool.</p>
</li>
<li>
<p>Make the transfer of <code>total rewards</code> USDC from the contract to Alice&#x27;s wallet.</p>
</li>
<li>
<p>Emit the event <code>RewardsClaimed</code>.</p>
</li>
</ul>
<p>Before the investor claims from the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the investor claims from the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lending data:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ &quot;amount&quot;: &quot;1100000000&quot;, &quot;claimedAmount&quot;: &quot;1100000000&quot; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The investor has claimed their rewards, and the total rewards paid out have been updated to reflect the claimed amount. In this example, as there is only one investor, the 100% of the rewards is disbursed to a single address.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="event-7-close-pool">Event #7 (close pool)<a href="#event-7-close-pool" class="hash-link" aria-label="Direct link to Event #7 (close pool)" title="Direct link to Event #7 (close pool)">​</a></h3>
<ul>
<li>
<p>This can only be done by the pool owner, in this case, it would be Bob.</p>
</li>
<li>
<p>The pool status will be marked with the status <code>CLOSED</code>.</p>
</li>
<li>
<p>Return the pool owner&#x27;s collateral tokens from the contract to Bob&#x27;s wallet.</p>
</li>
<li>
<p>Emit the event <code>PoolClosed</code>.</p>
</li>
</ul>
<p>Before the borrower closes the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the borrower closes the pool:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;softCap&quot;: &quot;1000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;hardCap&quot;: &quot;2000000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalCommitted&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalRewards&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;rewardsPaidOut&quot;: &quot;1100000000&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;createdAt&quot;: &quot;1707768557&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;deadline&quot;: &quot;1708632554&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;closedTime&quot;: &quot;1712952564&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolStatus&quot;: 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;poolOwner&quot;: &quot;0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Lending data:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{ &quot;amount&quot;: &quot;1100000000&quot;, &quot;claimedAmount&quot;: &quot;1100000000&quot; }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The pool status is set to 2 which represents <code>CLOSED</code> and the closed time is set to the current block timestamp.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/documentation/docs/tags/borrow">Borrow</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/documentation/docs/tags/lend">Lend</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/defactor-com/documentation/tree/main/docs/smart-contracts/Pools/example.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/documentation/docs/smart-contracts/Pools/smart-contract-erc20-collateral-pool-technical-aspects"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Technical Aspects</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/documentation/docs/category/erc20-collateral-pool"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">ERC20 Collateral Pool</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#in-depth-actions" class="table-of-contents__link toc-highlight">In-depth Actions</a></li><li><a href="#pool-lifecycle" class="table-of-contents__link toc-highlight">Pool lifecycle</a><ul><li><a href="#event-1-contract-initialization" class="table-of-contents__link toc-highlight">Event #1 (contract initialization)</a></li><li><a href="#event-2-create-a-pool" class="table-of-contents__link toc-highlight">Event #2 (create a pool)</a></li><li><a href="#event-3-commit-to-a-pool" class="table-of-contents__link toc-highlight">Event #3 (commit to a pool)</a></li><li><a href="#event-4-collect-from-pool" class="table-of-contents__link toc-highlight">Event #4 (collect from pool)</a></li><li><a href="#event-5-deposit-rewards" class="table-of-contents__link toc-highlight">Event #5 (deposit rewards)</a></li><li><a href="#event-6-claim-rewards" class="table-of-contents__link toc-highlight">Event #6 (claim rewards)</a></li><li><a href="#event-7-close-pool" class="table-of-contents__link toc-highlight">Event #7 (close pool)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/documentation/docs/category/api">API</a></li><li class="footer__item"><a class="footer__link-item" href="/documentation/docs/category/smart-contracts">Smart Contracts</a></li><li class="footer__item"><a class="footer__link-item" href="/documentation/docs/category/front-end">Front End</a></li><li class="footer__item"><a class="footer__link-item" href="/documentation/docs/category/real-world-use-cases">Real World Use Cases</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/defactor_official" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/S2SCMTPMUt" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/defactor_" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/defactor-com" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Defactor. All Rights Reserved</div></div></div></footer></div>
</body>
</html>