"use strict";(self.webpackChunkdocus=self.webpackChunkdocus||[]).push([[4351],{1243:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>l,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"engage/back-end-api/graphqlApi/graphql-api-authentication","title":"Authentication","description":"Security Details","source":"@site/docs/engage/back-end-api/graphqlApi/authentication.md","sourceDirName":"engage/back-end-api/graphqlApi","slug":"/engage/back-end-api/graphqlApi/graphql-api-authentication","permalink":"/docs/engage/back-end-api/graphqlApi/graphql-api-authentication","draft":false,"unlisted":false,"editUrl":"https://github.com/defactor-com/documentation/tree/main/docs/engage/back-end-api/graphqlApi/authentication.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"graphql-api-authentication","title":"Authentication","sidebar_position":1},"sidebar":"docSidebar","previous":{"title":"GraphQL API Endpoints","permalink":"/docs/category/graphql-api-endpoints"},"next":{"title":"Staking V1","permalink":"/docs/engage/back-end-api/graphqlApi/graphql-api-staking-v1"}}');var r=s(4848),i=s(8453);const a={id:"graphql-api-authentication",title:"Authentication",sidebar_position:1},c=void 0,o={},d=[{value:"Security Details",id:"security-details",level:2},{value:"<code>Login</code>",id:"login",level:2},{value:"<code>Restore Session</code>",id:"restore-session",level:2},{value:"<code>Update Account</code>",id:"update-account",level:2}];function h(e){const n={a:"a",code:"code",h2:"h2",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"security-details",children:"Security Details"}),"\n",(0,r.jsxs)(n.p,{children:["To secure the API access control, all requests are made through ",(0,r.jsx)(n.a,{href:"https://hasura.io/",children:"Hasura"})," which provides secure GraphQL, and RESTful endpoints restricted by a role-based authorization system."]}),"\n",(0,r.jsxs)(n.p,{children:["Those endpoints that return public blockchain data do not require authentication for use. Query type requests are opened under the ",(0,r.jsx)(n.code,{children:"guest"})," role, while mutation type needs a token with ",(0,r.jsx)(n.code,{children:"admin"})," role."]}),"\n",(0,r.jsx)(n.p,{children:"For those that can modify data the API expects a valid authorization header containing a bearer token. These tokens are implemented as JSON Web Tokens (JWTs) issued by the server."}),"\n",(0,r.jsx)(n.p,{children:"The security of the JWT is because it is signed by a secret key and has a configurable expiration time, which by default is 60 minutes."}),"\n",(0,r.jsx)(n.p,{children:"Upon receiving a request, Hasura decodes and validates the JWT, which contains user account data, and their corresponding role. If the role lacks the necessary permissions or the token is invalid, expired or missing, the request is promptly rejected."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"login",children:(0,r.jsx)(n.code,{children:"Login"})}),"\n",(0,r.jsx)(n.p,{children:"Retrieve an access token with the role of the user and a refresh token to regenerate a new access token."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"HTTP Method"}),": POST"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Roles"}),": Guest"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint"}),": ",(0,r.jsx)(n.code,{children:"{{BASE_URL}}/v1/login"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"GraphQL Body"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"mutation v1Login($session: LoginInput!) {\n  v1Login(session: $session) {\n    res\n    success\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Params"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "session": {\n    "message": "https://localhost:3000 wants you to sign in with your Ethereum account: 0xa8983Fe59b2F08F9F1B3E833c5D47B256F7FE0d5  Sign in with Ethereum to the app.  URI: https://localhost:3000 Version: 1 Chain ID: 1 Nonce: V4953jdM8Y5ljtOvZ Issued At: 2024-09-14T20:44:31.764Z Expiration Time: 2024-09-14T20:49:31.761Z",\n    "signature": "0x81596c2af98457f7621455ca947db35cad201cb96ced9b34a4b2403fea35c01431f7bca6db5fc5ffdb92b42c3cd0ae0c5b21cc24099ce6e630f0966e3fa544701c"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "v1Login": {\n    "res": {\n      "accessToken": "",\n      "refreshToken": ""\n    },\n    "success": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"restore-session",children:(0,r.jsx)(n.code,{children:"Restore Session"})}),"\n",(0,r.jsx)(n.p,{children:"Retrieve a new access token with the role of the user and a refresh token to regenerate a new access token."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"HTTP Method"}),": POST"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Roles"}),": Guest"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint"}),": ",(0,r.jsx)(n.code,{children:"{{BASE_URL}}/v1/graphql"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"GraphQL Body"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"mutation v1RestoreSession($session: RestoreSessionInput!) {\n  v1RestoreSession(session: $session) {\n    res\n    success\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Params"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "session": {\n    "refreshToken": "d1789988-2406-4937-bc3d-2f9e039e7e1b"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "v1RestoreSession": {\n    "res": {\n      "accessToken": "",\n      "refreshToken": ""\n    },\n    "success": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"update-account",children:(0,r.jsx)(n.code,{children:"Update Account"})}),"\n",(0,r.jsx)(n.p,{children:"Update the metadata of an existing account in multiple networks using the address."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"HTTP Method"}),": POST"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Roles"}),": User Admin"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Endpoint"}),": ",(0,r.jsx)(n.code,{children:"{{BASE_URL}}/v1/graphql"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"GraphQL Body"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"mutation v1UpdateAccount($account: UpdateAccountInput!) {\n  v1UpdateAccount(account: $account) {\n    res\n    success\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Params"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "account": {\n    "data": {\n      "networks": ["{{NETWORK_ETHEREUM}}", "{{NETWORK_POLYGON}}"],\n      "name": "name.eth",\n      "address": "0xa8983Fe59b2F08F9F1B3E833c5D47B256F7FE0d5"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "v1UpdateAccount": {\n    "res": {\n      "updatedIn": ["ethereum"]\n    },\n    "success": true\n  }\n}\n'})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>c});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);